# README

## Условия семинара

**IPC.**

Работают 3 НЕ родственных процесса. Каждый в командной строке получает данные для формирования ключа IPC - имя файла (должен существовать) и символ, также передаются имя файла, который является разделяемым ресурсом, и число N, которое задает продолжительность работы.  
Файл — разделяемый ресурс и в начале работы должен быть/стать пустым.

В цикле от 1 до N каждый выполняет свою работу:  
{  
1-й процесс пишет в файл строку - номер итерации и свой pid.  
2-ой и 3-ий процессы считывают эту строку, добавляют к ней свой pid и записывают ниже в файл строго по очереди, сначала 2-ой, потом 3-ий.  
Строки должны заканчиваться символом перевода строки `\n`.  
}

В результате в файле должно быть 3*N строк:  
```
n1 pid1  
n1 pid1 pid2  
n1 pid1 pid2 pid3  
```

**Синхронизировать работу процессов**  
1) с помощью семафоров  
2) с помощью очередей сообщений  

## Запуск программы

### Реализация через очереди сообщения
Для запуска необходимо последовательно в 3х терминалах запустить программы: сначала m1, m2, m3.

``` bash
gcc -g -Wall sem12_m1.c -o m1 && ./m1 keyfile a sharedfile 5
gcc -g -Wall sem12_m2.c -o m2 && ./m2 keyfile a sharedfile 5
gcc -g -Wall sem12_m3.c -o m3 && ./m3 keyfile a sharedfile 5
```

### Реализация через семафоры

Для запуска необходимо последовательно в 3х терминалах запустить программы: сначала s1, s2, s3.

``` bash
gcc -g -Wall sem12_s1.c -o s1 && ./s1 keyfile a sharedfile 5
gcc -g -Wall sem12_s2.c -o s2 && ./s2 keyfile a sharedfile 5
gcc -g -Wall sem12_s3.c -o s3 && ./s3 keyfile a sharedfile 5
```

``` bash
ipcs -s | awk 'NR > 3 {print $2}' | xargs -I {} ipcrm -s {}
```
удаление всех ipcs из терминала (программами предусмотрено удаление используемых ресурсов по окончании, но при удачных запусков, они могут накапливаться).

Проверить, очереди сообщений:

``` bash
ipcs -m
```
Семафоры:
``` bash
ipcs -s
```

